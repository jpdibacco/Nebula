{"code":"!function(t){var e={};function i(o){if(e[o])return e[o].exports;var s=e[o]={i:o,l:!1,exports:{}};return t[o].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var s in t)i.d(o,s,function(e){return t[e]}.bind(null,s));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,\"a\",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p=\"\",i(i.s=0)}([function(t,e){var i,o=60;(i=io.connect({query:\"username=\"+sessionStorage.getItem(\"username\")})).on(\"connect\",function(t){!function(t){var e=Date.now(),i=new s;i.init_socket(t),setInterval(function(){var o=Date.now()-e;e=Date.now(),i.Update(t,o),i.Render(o)},1e3/o),t.emit(\"init_client\",\"hello\")}(i)});class s{constructor(){this.shipReady=!1,this.shipImage=new Image,this.shipImage.onload=function(){this.shipReady=!0}.bind(this),this.shipImage.src=\"assets/greenShip.svg\",this.shipImage.height=\"auto\",this.canvas=document.getElementById(\"canvas\"),this.ctx=this.canvas.getContext(\"2d\");let t=Math.floor(500*Math.random()),e=Math.floor(500*Math.random());console.log(\"x\",t,\"y\",e),this.player_name=sessionStorage.getItem(\"username\"),this.player=new h({x:t,y:e,h:10,w:10,rot:0,health:100}),this.player.init_controller(),this.players=[],this.bullets=[],this.mouse_x=0,this.mouse_y=0}init_socket(t){t.on(\"players\",function(t){this.players=t.players,this.bullets=t.bullets,this.player_name in this.players&&(this.player.loc.health=this.players[this.player_name].health)}.bind(this)),t.on(\"died\",function(t){alert(\"You died!\"),location.reload()}.bind(this))}Update(t,e){this.player.Update(e),t.emit(\"move\",this.player.loc),this.player.shoot&&t.emit(\"shoot\")}Render(t){let e=this.ctx,i=this.canvas;for(var o in e.clearRect(0,0,e.canvas.width,e.canvas.height),this.player.Render(e),this.players){var s=this.players[o];e.drawImage(this.shipImage,s.x,s.y,100,50),e.font=\"30px Verdana\",e.fillText(o,s.x,s.y,100)}for(var h of this.bullets)n(e,{x:h.x+30,y:h.y+30,h:5,w:5},\"white\");$(\"body\").mousemove(function(t){var e=i.getBoundingClientRect();this.mouse_x=t.clientX-e.left,this.mouse_y=t.clientY-e.top,this.player.setRotation(this.mouse_x,this.mouse_y)}.bind(this))}}function n(t,e,i){t.fillStyle=i,t.fillRect(e.x,e.y,e.w,e.h)}class h{constructor(t){this.left=!1,this.right=!1,this.up=!1,this.down=!1,this.shoot=!1,this.loc=t}init_controller(){document.addEventListener(\"keydown\",this.checkKeyDown.bind(this)),document.addEventListener(\"keyup\",this.checkKeyUp.bind(this))}Update(t){this.setRotation();this.left&&(this.loc.x-=2),this.right&&(this.loc.x+=2),this.up&&(this.loc.y-=2),this.down&&(this.loc.y+=2)}setRotation(t,e){let i=t-this.loc.x,o=e-this.loc.y,s=180/Math.PI;if(0!==i)if(i>0&&o<0){let t=Math.atan(-o/-i)*s;this.loc.rot=t+360}else if(i>0&&o>0)this.loc.rot=Math.atan(o/i)*s;else if(i<0&&o>0){let t=Math.atan(o/i)*s;this.loc.rot=t+180}else if(i<0&&o<0){let t=Math.atan(o/i)*s;this.loc.rot=t+180}}Render(t,e){}checkKeyDown(t){t.preventDefault(),37===t.keyCode&&(this.left=!0),39===t.keyCode&&(this.right=!0),38===t.keyCode&&(this.up=!0),40===t.keyCode&&(this.down=!0),65===t.keyCode&&(this.left=!0),68===t.keyCode&&(this.right=!0),87===t.keyCode&&(this.up=!0),83===t.keyCode&&(this.down=!0),32===t.keyCode&&(this.shoot=!0,console.log(\"shot fired\"))}checkKeyUp(t){t.preventDefault(),37===t.keyCode&&(this.left=!1),39===t.keyCode&&(this.right=!1),38===t.keyCode&&(this.up=!1),40===t.keyCode&&(this.down=!1),65===t.keyCode&&(this.left=!1),68===t.keyCode&&(this.right=!1),87===t.keyCode&&(this.up=!1),83===t.keyCode&&(this.down=!1),32===t.keyCode&&(this.shoot=!1)}}}]);","extractedComments":[]}